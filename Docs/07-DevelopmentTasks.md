# 开发任务清单

## 阶段 A：基础设施

### A1. Supabase 项目配置
- [ ] 创建 Supabase 项目
- [ ] 获取项目 URL 和 anon key
- [ ] 配置 iOS 项目的 Supabase 客户端

### A2. 数据库表结构
- [ ] 创建 users 表
- [ ] 创建 works 表
- [ ] 创建 likes 表
- [ ] 创建 collections 表
- [ ] 创建 comments 表
- [ ] 创建 follows 表
- [ ] 配置所有表的 RLS 策略

### A3. Supabase Storage
- [ ] 创建 avatars bucket
- [ ] 创建 thumbnails bucket
- [ ] 创建 work-assets bucket
- [ ] 配置 bucket 访问权限

### A4. OAuth 配置
- [ ] Supabase 控制台启用 Apple 登录
- [ ] Supabase 控制台启用 Google 登录
- [ ] Apple Developer 配置 Sign in with Apple
- [ ] Google Cloud Console 配置 OAuth

---

## 阶段 B：认证模块

### B1. 认证服务层
- [ ] 创建 AuthService 单例
- [ ] 实现会话状态管理
- [ ] 实现登出逻辑
- [ ] 实现会话持久化

### B2. Apple 登录
- [ ] 添加 Sign in with Apple capability
- [ ] 实现 Apple 登录流程
- [ ] 处理登录回调

### B3. Google 登录
- [ ] 集成 Google Sign-In SDK (SPM)
- [ ] 配置 URL Scheme
- [ ] 实现 Google 登录流程
- [ ] 处理登录回调

### B4. 登录界面
- [ ] 创建登录页面 UI
- [ ] Apple 登录按钮
- [ ] Google 登录按钮
- [ ] 登录状态处理

---

## 阶段 C：核心渲染

### C1. WebView 封装
- [ ] 创建 WKWebView 的 SwiftUI 包装
- [ ] 实现 HTML 字符串加载
- [ ] 实现 JS 与 Swift 消息桥接
- [ ] 处理导航和错误

### C2. 作品渲染器
- [ ] 组装 HTML/CSS/JS 为完整文档
- [ ] 注入基础样式（viewport 等）
- [ ] CDN 库加载支持
- [ ] 渲染错误处理

### C3. 性能优化
- [ ] WebView 复用池
- [ ] 作品预加载策略
- [ ] 内存管理

---

## 阶段 D：数据层

### D1. 数据模型
- [ ] User 模型
- [ ] Work 模型
- [ ] Comment 模型
- [ ] 模型与 Supabase 映射

### D2. 数据服务
- [ ] WorkService（作品 CRUD）
- [ ] UserService（用户信息）
- [ ] InteractionService（点赞、收藏）
- [ ] CommentService（评论）
- [ ] FollowService（关注）

### D3. 本地缓存
- [ ] 作品内容缓存
- [ ] 用户信息缓存
- [ ] 缓存失效策略

---

## 阶段 E：主界面框架

### E1. Tab 结构
- [ ] 创建主 TabView
- [ ] 首页 Tab
- [ ] 发现 Tab
- [ ] 创作 Tab（入口）
- [ ] 个人中心 Tab

### E2. 导航架构
- [ ] 全局导航状态管理
- [ ] 页面跳转逻辑
- [ ] 深度链接支持（后期）

---

## 阶段 F：首页 Feed

### F1. Feed 容器
- [ ] 全屏作品容器
- [ ] 作品切换动画
- [ ] 上下切换按钮

### F2. 侧边操作栏
- [ ] 点赞按钮（含动画）
- [ ] 收藏按钮
- [ ] 评论按钮
- [ ] 分享按钮
- [ ] 作者头像入口

### F3. 作品信息层
- [ ] 作品标题
- [ ] 作者信息
- [ ] 作品描述（可展开）

### F4. Feed 数据流
- [ ] 推荐作品列表获取
- [ ] 无限滚动加载
- [ ] 下拉刷新

---

## 阶段 G：互动功能

### G1. 点赞
- [ ] 点赞/取消点赞
- [ ] 点赞状态同步
- [ ] 点赞动画

### G2. 收藏
- [ ] 收藏/取消收藏
- [ ] 收藏状态同步

### G3. 评论
- [ ] 评论列表页面
- [ ] 发表评论
- [ ] 回复评论
- [ ] 删除评论

### G4. 分享
- [ ] 系统分享面板
- [ ] 生成分享链接

---

## 阶段 H：个人中心

### H1. 个人主页
- [ ] 用户信息展示
- [ ] 关注/粉丝数量
- [ ] 编辑资料入口

### H2. 作品网格
- [ ] 我的作品列表
- [ ] 我的收藏列表
- [ ] 我的喜欢列表
- [ ] 网格/列表切换

### H3. 他人主页
- [ ] 查看他人主页
- [ ] 关注/取消关注按钮

### H4. 设置页面
- [ ] 账号设置
- [ ] 登出
- [ ] 关于

---

## 阶段 I：创作功能

### I1. 代码编辑器
- [ ] HTML 编辑区域
- [ ] CSS 编辑区域
- [ ] JS 编辑区域
- [ ] Tab 切换

### I2. 实时预览
- [ ] 预览区域
- [ ] 编辑后自动刷新
- [ ] 预览/编辑模式切换

### I3. 发布流程
- [ ] 填写作品信息（标题、描述）
- [ ] 生成预览图
- [ ] 上传到 Supabase
- [ ] 发布成功处理

### I4. 作品管理
- [ ] 编辑已发布作品
- [ ] 删除作品
- [ ] 草稿保存（后期）

---

## 阶段 J：发现页

### J1. 搜索
- [ ] 搜索输入框
- [ ] 搜索作品
- [ ] 搜索用户
- [ ] 搜索历史

### J2. 推荐内容
- [ ] 热门作品
- [ ] 推荐用户

---

## 阶段 K：优化与完善

### K1. 性能优化
- [ ] 启动优化
- [ ] 列表滚动优化
- [ ] 图片加载优化
- [ ] 内存优化

### K2. 用户体验
- [ ] 加载状态
- [ ] 错误提示
- [ ] 空状态
- [ ] 骨架屏

### K3. 其他
- [ ] 深色模式适配
- [ ] 多语言支持（后期）
- [ ] 无障碍支持

---

## 依赖关系

```
A (基础设施)
  └── B (认证)
        └── E (主界面)
              ├── F (首页) ← C (渲染) + D (数据)
              ├── H (个人中心) ← D (数据)
              ├── I (创作) ← C (渲染)
              └── J (发现) ← D (数据)
                    └── G (互动)
                          └── K (优化)
```

---

## MVP 最小范围

完成以下即可发布最小可用版本：

- A 全部
- B 全部
- C1, C2
- D1, D2（部分）
- E 全部
- F 全部
- G1, G2
- H1, H2（部分）
- I1, I2, I3

